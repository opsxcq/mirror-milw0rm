<html><head><title>Debian OpenSSH Remote SELinux Privilege Elevation Exploit (auth)</title></head><pre>/* Debian (maybe other derivates |KUDUBUTUNTU|) OpenSSH Remote -=Authenticated=- SELinux Privilege Elevation
*** Fedora/RHEL Linux should be tested because it _MAY_ contain the same vulnerability
*** in it's OpenSSH patches in a time slice. Latest OpenSSH should not be vulnerable. Older Debian Releases may.
**** One vulnerable example is &quot;openssh-SNAP-20070303.tar.gz&quot;, currently reachable at
****  ftp://ftp.bit.nl/mirror/openssh/openssh-SNAP-20070303.tar.gz
****
*** See the &quot;Diff Patch&quot; by Debian:
*** +		authctxt-&gt;role = role ? xstrdup(role) : NULL;
**** Where the role is defined in the username after a forward slash '/'
**** So anyone can set arbritrary SELinux roles, when OpenSSH is configured with --with-selinux - 
**** What is a common configuration nowadays.
**** For the kids:
***** ssh -lusername:[style]/&lt;arbritrary SELinux role&gt; host
***** ssh -p2222 -lusername:/wishedrole 127.0.0.1
**** ':' means [style] -&gt; [[not relevant]] '/'&lt;arbritrary SELinux role&gt; is the specified SELinux role.
**** 
**** This seams to be a bug jailed in some distros because of legacy code.
****
**** 'Exploit' found and delivered by Kingcope.
***//Želiteb0yŽ//
**** CHEERIO ****/
REM blablablaIHAVEPRETTYIDEAHOWSELINUXRUNSWORKSORWHATEVERblablabla

# milw0rm.com [2008-07-17]</pre></html>